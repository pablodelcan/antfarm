<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Antfarm</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;1,400&family=Inter:wght@300;400;500;600;700;800;900&display=swap');
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: #e8e5e0; color: #1a1a1a;
    font-family: 'Inter', -apple-system, sans-serif;
    height: 100vh; overflow: hidden; -webkit-font-smoothing: antialiased;
  }

  /* ── Intro Screen ── */
  .intro {
    position: fixed; inset: 0; background: #e8e5e0;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    z-index: 100; transition: opacity 0.8s ease;
  }
  .intro.hide { opacity: 0; pointer-events: none; }
  .intro h1 {
    font-family: 'EB Garamond', serif; font-size: clamp(2.5rem, 5vw, 4.5rem);
    font-weight: 400; font-style: italic; margin-bottom: 12px; letter-spacing: -0.01em;
  }
  .intro .sub { color: #999; font-size: 0.82rem; letter-spacing: 0.08em; margin-bottom: 12px; }
  .intro .sub2 { color: #bbb; font-size: 0.7rem; letter-spacing: 0.06em; margin-bottom: 48px; }
  .intro button {
    background: none; border: 1px solid #ccc; color: #1a1a1a;
    font-family: 'Inter', sans-serif; font-size: 0.78rem; letter-spacing: 0.14em;
    text-transform: uppercase; padding: 14px 44px; cursor: pointer; transition: all 0.3s;
  }
  .intro button:hover { border-color: #1a1a1a; background: #1a1a1a; color: #fff; }

  /* ── App Layout ── */
  .app {
    display: none; height: 100vh; flex-direction: column;
    align-items: center; justify-content: center;
    padding: 20px;
  }

  /* ── Main Card ── */
  .main-card {
    background: #fff;
    border-radius: 20px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.06), 0 4px 16px rgba(0,0,0,0.04);
    display: flex; flex-direction: column;
    max-width: 1100px; width: 100%;
    max-height: 100%;
    overflow: hidden;
  }

  /* ── Topbar ── */
  .topbar {
    display: flex; align-items: baseline; justify-content: space-between;
    padding: 18px 28px 14px; flex-shrink: 0;
  }
  .topbar .title {
    font-family: 'EB Garamond', serif; font-size: 1.8rem; font-weight: 400;
    font-style: italic; letter-spacing: -0.01em; line-height: 1;
  }
  .topbar .stats {
    display: flex; gap: 24px; font-size: 0.82rem; color: #1a1a1a;
    align-items: baseline;
  }
  .topbar .stats .stat-group {
    display: flex; align-items: baseline; gap: 6px;
  }
  .topbar .stats .stat-label {
    font-weight: 400; font-size: 0.82rem; color: #1a1a1a;
  }
  .topbar .stats .stat-val {
    font-weight: 700; font-size: 0.82rem; font-variant-numeric: tabular-nums;
  }

  /* ── Intel Bar ── */
  .intel-bar {
    display: flex; align-items: center; justify-content: space-between;
    padding: 0 28px 12px; flex-shrink: 0;
    font-size: 0.68rem; color: #888; gap: 12px;
    border-bottom: 1px solid #f0f0f0;
  }
  .intel-bar .intel-left {
    display: flex; align-items: center; gap: 12px;
  }
  .intel-bar .intel-dot {
    width: 5px; height: 5px; border-radius: 50%; background: #1a1a1a; flex-shrink: 0;
  }
  .intel-bar .intel-label {
    font-weight: 600; color: #1a1a1a; font-size: 0.68rem;
  }
  .intel-bar .intel-focus {
    font-family: 'EB Garamond', serif; font-style: italic; font-size: 0.82rem;
    color: #1a1a1a; font-weight: 500;
  }
  .intel-bar .intel-sep {
    color: #ccc; font-size: 0.72rem;
  }
  .intel-bar .intel-roles {
    color: #999; font-size: 0.65rem; letter-spacing: 0.02em;
  }
  .intel-bar .intel-right {
    display: flex; align-items: center; gap: 8px;
    font-family: 'EB Garamond', serif; font-style: italic; font-size: 0.78rem;
    color: #bbb;
  }

  /* ── Canvas Area ── */
  .canvas-wrap {
    flex: 1; position: relative; overflow: hidden;
    display: flex; align-items: center; justify-content: center;
    min-height: 0;
  }
  .canvas-wrap canvas {
    display: block; cursor: crosshair; width: 100%; height: 100%;
    border: 1px solid #e0e0e0; border-radius: 2px;
  }

  /* ── Bottom Bar ── */
  .bottombar {
    display: flex; align-items: center; justify-content: center;
    padding: 10px 28px; flex-shrink: 0;
  }
  .bottombar .status {
    font-size: 0.72rem; color: #1a1a1a; font-weight: 600;
    display: flex; align-items: center; gap: 6px;
  }
  .bottombar .status .dot {
    width: 6px; height: 6px; border-radius: 50%; background: #1a1a1a;
  }

  /* ── Tooltip ── */
  .ant-tooltip {
    position: fixed; pointer-events: none;
    background: rgba(255,255,255,0.95); backdrop-filter: blur(8px);
    border: 1px solid #e0e0e0; padding: 8px 12px;
    font-size: 0.68rem; line-height: 1.5; color: #555;
    z-index: 50; opacity: 0; transition: opacity 0.15s ease; max-width: 220px; white-space: nowrap;
    border-radius: 8px;
  }
  .ant-tooltip.show { opacity: 1; }
  .ant-tooltip .tt-name { color: #1a1a1a; font-weight: 500; margin-bottom: 2px; font-size: 0.72rem; }
  .ant-tooltip .tt-row { display: flex; justify-content: space-between; gap: 12px; }
  .ant-tooltip .tt-val { color: #1a1a1a; font-weight: 500; }

  /* ── Toast ── */
  .toast {
    position: fixed; bottom: 48px; left: 50%; transform: translateX(-50%) translateY(8px);
    background: #1a1a1a; color: #fff; padding: 8px 20px; font-size: 0.72rem;
    opacity: 0; transition: all 0.25s ease; z-index: 90; pointer-events: none;
    border-radius: 6px;
  }
  .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

  /* ── Hidden Admin Panel (j+k+l) ── */
  .admin-panel {
    position: fixed; bottom: 44px; left: 50%; transform: translateX(-50%);
    background: rgba(20,20,20,0.95); backdrop-filter: blur(10px);
    border: 1px solid #333; padding: 12px 20px;
    display: none; align-items: center; gap: 16px;
    z-index: 80; border-radius: 6px;
  }
  .admin-panel.show { display: flex; }
  .admin-panel button {
    background: #333; color: #ddd; border: 1px solid #555;
    font-family: 'Inter', sans-serif; font-size: 0.65rem;
    padding: 6px 14px; cursor: pointer; transition: all 0.2s;
    letter-spacing: 0.04em; text-transform: uppercase;
  }
  .admin-panel button:hover { background: #555; color: #fff; }

  /* ── Hidden data elements ── */
  .hidden-data { display: none; }
</style>
</head>
<body>

<!-- Intro Screen -->
<div class="intro">
  <h1>Antfarm</h1>
  <div class="sub">A living colony powered by Claude AI</div>
  <div class="sub2">v11</div>
  <button onclick="begin()">Enter</button>
</div>

<!-- Main App -->
<div class="app" id="app">
  <div class="main-card">
    <div class="topbar">
      <div class="title">Antfarm</div>
      <div class="stats">
        <div class="stat-group"><span class="stat-label">Population</span><span class="stat-val" id="sAnts">0</span></div>
        <div class="stat-group"><span class="stat-label">Tunneled</span><span class="stat-val" id="sTunnel">0%</span></div>
        <div class="stat-group"><span class="stat-label">Chambers</span><span class="stat-val" id="sChambers">0</span></div>
        <div class="stat-group"><span class="stat-label">Day</span><span class="stat-val" id="sDay">1</span></div>
      </div>
    </div>

    <div class="intel-bar" id="intelBar">
      <div class="intel-left">
        <span class="intel-dot"></span>
        <span class="intel-label">Claude AI</span>
        <span class="intel-sep">|</span>
        <span class="intel-focus" id="intelFocusDisplay">Observing colony</span>
        <span class="intel-roles" id="intelRolesDisplay"></span>
        <span class="intel-roles" id="intelTokensDisplay"></span>
      </div>
      <div class="intel-right">
        <span id="intelInsightDisplay"></span>
      </div>
    </div>

    <div class="canvas-wrap" id="wrap">
      <canvas id="c"></canvas>
    </div>

    <div class="bottombar">
      <div class="status">
        <span class="dot"></span>
        <span id="statusText">Day 1</span>
      </div>
    </div>
  </div>
</div>

<!-- Hidden data trackers -->
<div class="hidden-data">
  <span id="intelFocus"></span>
  <span id="intelRoles"></span>
  <span id="intelTokens"></span>
  <span id="intelInsight"></span>
  <span id="aiNarration"></span>
</div>

<!-- Tooltip -->
<div class="ant-tooltip" id="tooltip">
  <div class="tt-name" id="ttName"></div>
  <div class="tt-row"><span>State</span><span class="tt-val" id="ttState"></span></div>
  <div class="tt-row"><span>Energy</span><span class="tt-val" id="ttEnergy"></span></div>
  <div class="tt-row"><span>Role</span><span class="tt-val" id="ttRole"></span></div>
  <div class="tt-row"><span>Thought</span><span class="tt-val" id="ttThought"></span></div>
</div>

<div class="toast" id="toast"></div>

<!-- Hidden Admin Panel -->
<div class="admin-panel" id="adminPanel">
  <button onclick="adminAction('addAnts')">+5 Ants</button>
  <button onclick="adminAction('dropFood')">Drop Food</button>
  <button onclick="if(confirm('Reset?')) restartColony()" style="background:#8b0000;color:#fff">Reset</button>
</div>

<!-- Scripts -->
<script src="/js/constants.js?v=14"></script>
<script src="/js/terrain.js?v=14"></script>
<script src="/js/pheromones.js?v=14"></script>
<script src="/js/ant.js?v=14"></script>
<script src="/js/behavior.js?v=14"></script>
<script src="/js/colony.js?v=14"></script>
<script src="/js/renderer.js?v=14"></script>
<script src="/js/network.js?v=14"></script>
<script src="/js/main.js?v=14"></script>

</body>
</html>
